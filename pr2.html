<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    .state {
      fill: #C20909 ;
      stroke: #000;
    }
    .state:hover {
      fill: #f0f0f0;
    }
    .state-label {
      fill: black;
      font-size: 12px;
      text-anchor: middle;
      pointer-events: none;
    }
    .slider-container {
  width: 300px;
  margin: 20px;
}

#slider {
  width: 100%;
}

#slider-value {
  display: block;
  text-align: center;
  margin-top: 10px;
}
.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-button {
  background-color: #f1f1f1;
  color: #333;
  border: none;
  padding: 10px 20px;
  cursor: pointer;
}

.dropdown-menu {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
  z-index: 1;
  list-style: none;
  padding: 0;
  margin: 0;
}

.dropdown-menu li a {
  display: block;
  padding: 10px 20px;
  text-decoration: none;
  color: #333;
}

.dropdown-menu li a:hover {
  background-color: #ddd;
}
.nav-container {
  display: flex;
}



  </style>
</head>
<nav>
  <div class="nav-container">
  <div class="slider-container">
    <input type="range" id="slider" min="1997" max="2017" value="1997" step="1">
    <span id="slider-value">1997</span>
  </div>
  <div class="dropdown">
    <button class="dropdown-button">Cause Name</button>
    <ul class="dropdown-menu">
      <li><a href="#">All causes</a></li>
      <li><a href="#">Unintentional injuries</a></li>
      <li><a href="#">Alzheimer's disease</a></li>
      <li><a href="#">Stroke</a></li>
      <li><a href="#">Chronic lower respiratory diseases</a></li>
      <li><a href="#">Diabetes</a></li>
      <li><a href="#">Heart disease</a></li>
      <li><a href="#">Influenza and pneumonia</a></li>
      <li><a href="#">Suicide</a></li>
      <li><a href="#">Cancer</a></li>
      <li><a href="#">Kidney disease</a></li>
    </ul>
  </div>
</div>
</nav>
  <body></body>
  
  <!-- Step 1: Load D3 and TopoJSON libraries -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/topojson@3"></script>
  <script>
    (async () => {
      // Step 2: Load the US map data using TopoJSON
      const us = await d3.json('a.json');
      const mapData = topojson.feature(us, us.objects.states).features;
     const data = await d3.json("csvjson.json");
     

      // Step 3: Draw the SVG
      const width = 960;
      const height = 600;
      const svg = d3.select('body')
        .append('svg')
        .attr('width', width)
        .attr('height', height);

      // Step 4: Create an instance of geoPath
      const path = d3.geoPath();

      // Step 5: Use the path to plot the US map
      svg.selectAll('.state')
        .data(mapData)
        .enter()
        .append('path')
        .attr('class', 'state')
        .attr('d', path);

      // Step 6: Add state names
      svg.selectAll('.state-label')
        .data(mapData)
        .enter()
        .append('text')
        .attr('class', 'state-label')
        .attr('transform', function(d) {
          const centroid = path.centroid(d);
          return `translate(${centroid})`;
        })
        .text(function(d) {
          return d.states;
        });

      // Step 7: Add interactivity to the map
      svg.selectAll('.state')
      .data(data)
      .data(mapData)
      .enter()

        .on('click', function (event, d) {

          d3.select("year").html(`${d.name} <br/> Broj stanovnika: ${d.state} <br/> `);
        });
        // Find state with max Age-adjusted Death Rate
        var maxDeathRate = 0;
        var stateWithMaxDeathRate = "";
        data.forEach(function(item) {
          
  if (item["Age-adjusted Death Rate"] > maxDeathRate) {
    maxDeathRate = item["Age-adjusted Death Rate"];
    stateWithMaxDeathRate = item.State;
  }
});

console.log("Država s najvećim Age-adjusted Death Rate je: " + stateWithMaxDeathRate);

var slider = document.getElementById("slider");
var sliderValue = document.getElementById("slider-value");

// Update the slider value when the user interacts with it
slider.oninput = function() {
  sliderValue.textContent = this.value;
};
var finalValue = null;
var global=0;
var list= [];
function promjenaVrijednostiSlidera(novaVrijednost) {
  window.global = novaVrijednost;
  console.log(global);
}




slider.onchange = function() {
  
  finalValue = this.value;
  list.push(finalValue);
 // console.log(finalValue);
  console.log("Final value: " + finalValue);
  //console.log(list);
  
};

list.forEach(function(a)
{
  console.log(a);
});

// // Get the final value when the user finishes interacting with the slider
var dropdownButton = document.querySelector('.dropdown-button');
var dropdownMenu = document.querySelector('.dropdown-menu');
var dropdownOptions = dropdownMenu.querySelectorAll('a');

dropdownButton.addEventListener('click', function() {
  dropdownMenu.style.display = dropdownMenu.style.display === 'block' ? 'none' : 'block';
});
// select cause 
var selectedOption;
dropdownOptions.forEach(function(option) {
  option.addEventListener('click', function() {
     selectedOption = option.textContent;
    console.log('Selected option:', selectedOption);
  });
});

window.addEventListener('click', function(event) {
  if (!dropdownButton.contains(event.target)) {
    dropdownMenu.style.display = 'none';
  }
});
data.forEach(function(item) {
  if (item["Year"] == finalValue && item["Cause Name"]==selectedOption) {
    list.push(item.State);
    
    
  }
});



    })();
  </script>
</body>
</html>
